name       : aa-lsm-hook
version    : 0.0.1
release    : 2
source     :
    - https://github.com/solus-project/aa-lsm-hook/releases/download/v0.0.1/aa-lsm-hook-0.0.1.tar.xz : 2f07edf8b4866bfd351f0f547cb604c330dc5b1320eebd43fd3d85bbbde5a4b0
license    : GPL-2.0
component  : system.base
summary    : AppArmor system integration
description: |
    AppArmor system integration
builddeps  :
    - musl-devel
optimize   :
    - size
    - lto
setup      : |
    %apply_patches
    export CC=musl-gcc
    # We want tiny musl binary to make it load faster
    %meson_configure -Dwith-static-binary=true
build      : |
    LD_PRELOAD='' %meson_build
install    : |
    LD_PRELOAD='' %meson_install

    # Pre-enable service for Solus users
    install -D -d -m 00755 $installdir/usr/lib/systemd/system/sysinit.target.wants 
    ln -sv ../aa-lsm-hook.service $installdir/usr/lib/systemd/system/sysinit.target.wants/aa-lsm-hook.service
